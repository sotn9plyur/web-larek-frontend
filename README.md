# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей 
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# Архитектура проекта
Архитертура проекта основывается на паттерне графических интерфейсов (MVP), который разделяет приложение на три части:
- Model - классы Model и AppState, которые отвечают за доступ к данным: получение, обновление и удаление.
- View - классы Card, Component, Order, Form, Basket, Page, отвечают за отображение данных пользователю и взаимодействие с ним.
- Presenter - служит прослойкой между Model и View.

## Об архитектуре.
Взаимодействия внутри приложения происходят через события. Модели инициализируют события, слушатели событий в основном коде выполняют передачу данных компонентам отображения, а также вычислениями между этой передачей, и еще они меняют значения в моделях.

# Базовый код
##  Класс EventEmitter 
Брокер событий, позволяет подписываться на событие и реагировать на него.
Конструктор создает пустую коллекцию для хранения событий и их подписчиков.

Методы:
- on - устанавливает обработчик событий;
- off - снимает обработчик событий;
- onAll - устанавливает обработчик на все события;
- offAll - снимает обработчик со всех событий;
- emit - инициирует события с данными;
- trigger - устанавливает callback-trigger, генерирующий данное событи епри вызове.

## Класс API 
Базовый класс для взаимодействия с сервером.
Конструктор:
- baseUrl: string — адрес сервера;
- options: RequestInit = {} — объект опций.

Методы:
- get - получает запросы с сервера;
- post - отправляет данные на сервер;
- handleResponse - обрабатывает ответы с сервера, выдавая ошибки;

## Класс Model 
Управляет данными и взаимодействует с системой событий. Получает тип в виде дженерика: Model<T>.
Конструктор: 
- data: Partial<T> — данные;
- events: IEvents — объект событий.

Методы: 
- emitChanges - инициирует событие с переданным названием и данными, уведомляя подписчиков в изменении модели;

## Класс AppState 
Представляет центральную модель для управления состоянием проекта, включая данные каталога продуктов, корзину, информацию о заказе и ошибки валидации форм. Конструктор наследуется от Model.
Методы:
- setCatalog - устанавливает список товаров;
- setPreview - устанавливает предпросмотр товаров и инициализирует событие об изменении;
- addToBasket - добавление товаров в корзину;
- removeToBasket - удаление товара из корзины;
- clearBasket - очистить корзину;
- validateAddress - валидация полей доставки;
- validateContacts - валидация полей контактов;
- getTotal - рассчитываем итоговую стоимость товаров;

## Класс Component 
Базовый класс, реализующий методы отрисовки пользовательского интерфейса, предоставляющий инструментарий для работы с DOM-элементами.
Конструктор:
container: HTMLElement - принимает элемент контейнера, в который будет помещен компонент. 

Методы:
- toggleClass - переключает класс;
- setImage - устанавливает изображение с альтернативным тектом;
- setVisible - показывает элемент;
- setHidden - скрывет элемент;
- setDisabled - меняет статус блокировки элемеента;
- render(data?: Partial<T>) - выводит контейнер на страницу;

## Класс Card 
Представляет собой компонент карточки товара, наследуется от Component, получает тип в виде дженерика: Card<T>, содержит сеттеры и геттеры:
- set id - устанавливает id товара / get id - получить id товара;
- set category - устанавливает категорию товара;
- set title - устанавливает название товара / get title - получить название товара;
- set image - устанавливает изображение товара;
- set description - устанавливает описание товара;
- set price - устанавливает цену товара;
- set button - устанавливает текст кнопки товара;
- set index - установить индекс товара / get index - получить индекс товара.

Конструктор:
- container: HTMLElement — принимает элемент контейнера для вставки карточки;
- actions?: ICardActions — действия для установки на слушатели событий.

## Класс Form 
Предназначен для управления формами, наследует класс Component. Получает тип в виде дженерика: Form<T>.
Конструктор:
- container: HTMLFormElement — контейнер для вставки данных;
- events: IEvents — объект событий.

Методы:
- onInputChange - вызывается при изменении формы;
- set valid - устанавливает валидацию форм;
- set errors - устанавливает вывод информации об ошибке;
- render - выводит обновлённое состояние валидности;

## Класс Order 
Наследует класс Form, включает в себя выбор способа оплаты, указание контактных данных и адреса пользователя.
Конструктор:
- container: HTMLElement — контейнер для вставки данных
- events: IEvents — объект событий

Методы:
- select paymentMethod - выбирает способ оплаты;
- set address - адрес доставки;
- set phone - контакты пользователя; 
- set email - email пользователя;

## Класс Basket 
Управляет отображением корзины, наследует класс Component, содержит сеттеры:
- set item - устанавливает элементы в корзину;
- set selected - устанавлтвает наличие товаров в корзине;
- set total - устанавливает общую стоимость товара.

Констурктор:
- container: HTMLElement — контейнер для вставки данных;
- events: EventEmitter — объект событий.

## Класс Page 
Класс предназначенный для управления элементами интерфейса главной страницы, включает в себя каталог карточек товаров, счетчик товаров в корзине и блокировку прокрутки страницы, наследует класс Component.
- set catalog - выводит карточки на страницу;
- set counter - обновляет счетчик тотваров в корзине;
- set locked - блоукирует прокрутку страницы.

Конструктор:
- container: HTMLElement — контейнер для вставки карточек;
- events: IEvents — объект событий.

## Класс Modal 
Отображение модального окна, наследует класс Component, отвечает за открытие, закрытие, и управление его содержимым.
Конструктор:
- container: HTMLElement — контейнер для вставки данных;
- events: IEvents — объект событий.

Методы: 
- open - открытие модального окна;
- close - закрытие модального окна;
- set content - задает содержимое модального окна;
- render - отрисовывает данные и выводит их в модальном окне;

# Типы данных
export type TProductCategory = 'софт-скил' | 'другое' | 'дополнительное' | 'кнопка' | 'хард-скил' ;
export type TPayment = 'онлайн' | 'при получении' ;

//данные карточек товара
export interface IProduct {
    id: string;
    category: TProductCategory;
    title: string;
    description: string;
    price: number | null;
    image?: string;
}

//данные заказа
export interface IProductOrder {
    item: IProduct;
    total: number;
}

//данные формы оплаты и контактов 
export interface IOrderForm {
    payment: TPayment;
    address: string;
    email: string;
    phone: string;
}

//данные корзины
export interface IBasket {
    item: IProduct;
    price: number;
    total: number;
}

//данные успешного заказа
export interface IOrderSuccess {
    id: string;
    total: number;
}

//все данные компонентов приложения
export interface IAppState {
    catalog: IProduct[];
    basket: string [];
    preview: string | null;
    order: IOrderForm | null;
}
